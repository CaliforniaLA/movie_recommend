{% extends "base.html" %}
{% block title %}Index{% endblock %}
{% block head %}
    {{ super() }}
{% endblock %}
{% block content %}
    <div style="text-align: center">
        <h1>登录</h1>
        <el-form ref="form" :model="form" label-width="80px">
            <el-form-item label="账户">
                <el-input v-model="form.account" size="medium"></el-input>
            </el-form-item>
            <el-form-item label="密码">
                <el-input v-model="form.password" size="medium" type="password"></el-input>
            </el-form-item>
            <p style="color: red">{{ msg }}</p>
            <el-form-item>
                <el-button type="primary" @click="login">登录</el-button>
                <el-button @click="register">注册</el-button>
            </el-form-item>
        </el-form>
    </div>
{% endblock %}
{% block vue %}

    <script>
        {#Vue.http.options.emulateJSON = true;#}
        new Vue({
            el: '#app',
            data: {
                form: {
                    account: '',
                    password: ''
                },
                msg: ''
            },
            methods: {
                login: function () {
                    this.$http.post('/login', {
                        account: this.form.account,
                        password: this.form.password

                    }, {emulateJSON: true}).then(function (data) {
                        this.msg = data.body;
                        if(this.msg === 'success') {
                            window.location.href='/main'
                        }
                    }, function (response) {
                        console.info(response);
                    })
                },
                register: function () {
                    window.location.href = '/register'
                }
            }
        })
    </script>
{% endblock %}
